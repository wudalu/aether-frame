# Aether Frame Project Layout

This document defines the complete directory structure and organization of the Aether Frame project based on the Framework Abstraction Layer architecture.

## Overall Project Structure

```
aether-frame/
├── pyproject.toml                   # Project metadata configuration
├── requirements/                    # Dependency management directory
│   ├── base.in                     # Base dependencies (manually maintained)
│   ├── dev.in                      # Development dependencies (manually maintained)
│   ├── base.txt                    # Compiled base dependencies (generated by pip-compile)
│   └── dev.txt                     # Compiled dev dependencies (generated by pip-compile)
├── README.md
├── CHANGELOG.md
├── .gitignore
├── .env.example                    # Environment variable template
├── dev.py                          # Python-based development command management
├── docs/                          # Documentation directory
│   ├── architecture.md            # Architecture design document
│   ├── framework_abstraction.md   # Framework abstraction layer design
│   └── layout.md                  # This document
├── scripts/                       # Scripts directory
│   ├── compile-requirements.sh    # Dependency compilation script
│   ├── setup.sh                   # Environment setup script
│   └── dev-tools/                 # Development tool scripts
├── tests/                         # Test directory
│   ├── __init__.py
│   ├── unit/                      # Unit tests
│   ├── integration/               # Integration tests
│   ├── e2e/                       # End-to-end tests
│   └── fixtures/                  # Test data
└── src/                           # Source code root directory
    └── aether_frame/              # Main package
        ├── __init__.py
        ├── main.py                # Application entry point
        ├── contracts/             # Data contracts layer
        ├── execution/             # Application Execution Layer
        ├── framework/             # Framework Abstraction Layer
        ├── agents/                # Core Agent Layer
        ├── tools/                 # Tool Service Layer
        ├── infrastructure/        # Infrastructure Layer
        ├── config/                # Configuration module
        └── common/                # Common utilities module
```

## Core Module Detailed Structure

### Data Contracts Layer (contracts/)
Defines all data structures for inter-layer communication following the Framework Abstraction Layer design.

```
contracts/
├── __init__.py
├── requests.py         # TaskRequest, AgentRequest, ToolRequest
├── responses.py        # TaskResult, AgentResponse, ToolResult
├── contexts.py         # UserContext, SessionContext, ExecutionContext
├── configs.py          # AgentConfig, ExecutionConfig, StrategyConfig
└── enums.py           # FrameworkType, TaskStatus, ToolStatus, etc.
```

### Configuration Module (config/)
```
config/
├── __init__.py
├── settings.py         # Application settings
├── logging.py          # Logging configuration
└── environment.py      # Environment variable management
```

### Common Utilities Module (common/)
```
common/
├── __init__.py
├── utils.py           # Common utility functions
├── exceptions.py      # Custom exceptions
├── constants.py       # Constant definitions
└── types.py           # Type definitions
```

### Application Execution Layer (execution/)
Corresponds to the Application Execution Layer in the architecture, responsible for task execution orchestration and framework routing.

```
execution/
├── __init__.py
├── ai_assistant.py     # AIAssistant - system entry point
├── execution_engine.py # ExecutionEngine - central orchestration
└── task_router.py      # TaskRouter - strategy selection
```

### Framework Abstraction Layer (framework/)
Provides unified interfaces for multiple agent frameworks with framework-specific implementations.

```
framework/
├── __init__.py
├── framework_registry.py # FrameworkRegistry - framework adapter management
├── base/              # Abstract base classes
│   ├── __init__.py
│   ├── framework_adapter.py # FrameworkAdapter ABC
│   └── agent_manager.py     # AgentManager interface
├── adk/               # ADK framework implementation
│   ├── __init__.py
│   └── adk_adapter.py       # AdkFrameworkAdapter
├── autogen/           # AutoGen framework implementation
│   ├── __init__.py
│   └── adapter.py     # AutoGenFrameworkAdapter (future)
└── langgraph/         # LangGraph framework implementation
    ├── __init__.py
    └── adapter.py     # LangGraphFrameworkAdapter (future)
```

### Core Agent Layer (agents/)
Provides unified agent management and framework-agnostic agent interfaces.

```
agents/
├── __init__.py
├── manager.py         # AgentManager - unified agent lifecycle management
├── base/              # Abstract agent interfaces
│   ├── __init__.py
│   ├── domain_agent.py # DomainAgent ABC
│   └── agent_hooks.py  # AgentHooks interface
└── adk/               # ADK-specific domain agent implementations
    ├── __init__.py
    ├── adk_domain_agent.py # AdkDomainAgent
    └── adk_agent_hooks.py  # AdkAgentHooks
```

### Tool Service Layer (tools/)
Unified tool execution service supporting multiple tool types and protocols.

```
tools/
├── __init__.py
├── service.py         # ToolService - unified tool interface
├── base/              # Abstract tool interfaces
│   ├── __init__.py
│   └── tool.py        # Tool ABC
├── builtin/           # Built-in system tools
│   ├── __init__.py
│   └── tools.py       # Echo, timestamp, etc.
├── adk_native/        # ADK framework native tool wrappers
│   ├── __init__.py
│   └── wrappers.py
└── mcp/               # Model Context Protocol integration
    ├── __init__.py
    ├── client_manager.py # MCPClientManager
    └── tools.py       # MCPTool implementation
```

### Infrastructure Layer (infrastructure/)
Core infrastructure services including memory, session management, and observability.

```
infrastructure/
├── __init__.py
├── session/           # Session Manager - session lifecycle
│   ├── __init__.py
│   └── manager.py
├── storage/           # State Store - state persistence
│   ├── __init__.py
│   └── providers.py
├── logging/           # Logging System - centralized logging
│   ├── __init__.py
│   └── handlers.py
├── monitoring/        # Monitoring - performance metrics
│   ├── __init__.py
│   └── collectors.py
└── adk/               # ADK-specific infrastructure adapters
    ├── __init__.py
    ├── adk_memory_adapter.py  # ADK context.state integration
    └── adk_observer.py        # ADK monitoring integration
```

## Dependency Management Strategy

### pip-tools Workflow

1. **Write Dependency Requirements** (`requirements/*.in`)
   - Only write direct dependencies and version constraints
   - Separate base dependencies and development dependencies

2. **Compile Locked Versions** (`requirements/*.txt`)
   ```bash
   python dev.py compile-deps
   ```

3. **Install Dependencies**
   ```bash
   # Production environment
   python dev.py install
   
   # Development environment
   python dev.py dev-install
   ```

### Development Commands

```bash
# Compile dependencies
python dev.py compile-deps

# Install production dependencies
python dev.py install

# Install development dependencies
python dev.py dev-install

# Run tests
python dev.py test

# Clean cache
python dev.py clean
```

## Architecture Layer Mapping

| Architecture Layer | Directory | Description |
|-------------------|-----------|-------------|
| Application Execution Layer | `execution/` | Entry point, orchestration, and framework routing |
| Framework Abstraction Layer | `framework/` | Multi-framework support with unified interfaces |
| Core Agent Layer | `agents/` | Agent lifecycle management and abstract interfaces |
| Tool Service Layer | `tools/` | Unified tool execution and management |
| Infrastructure Layer | `infrastructure/` | Session, storage, logging, monitoring, and ADK adapters |
| Data Contracts Layer | `contracts/` | Inter-layer communication data structures |
| Configuration | `config/` | Settings and environment management |
| Common Utilities | `common/` | Shared utilities and exceptions |

## Development Conventions

1. **Code Organization**: Organized by architectural layers with clear separation of concerns
2. **Data Contracts**: All inter-layer communication through well-defined data structures
3. **Framework Abstraction**: Framework-specific code isolated in framework/ subdirectories
4. **Infrastructure Services**: Cross-cutting concerns handled by infrastructure layer
5. **Dependency Management**: Use pip-tools to manage deterministic dependencies
6. **Testing Strategy**: Separate unit tests, integration tests, and end-to-end tests
7. **Configuration Management**: Environment variables + configuration file separation
8. **Observability**: Built-in logging and monitoring through infrastructure layer

## Extension Guide

### Adding New Framework Support
```
framework/new_framework/
├── __init__.py
├── adapter.py          # NewFrameworkAdapter extending FrameworkAdapter
└── (configuration files specific to the framework)
```

**Agent implementations for new frameworks go in the agents layer:**
```
agents/new_framework/
├── __init__.py
├── new_domain_agent.py # Framework-specific domain agent
└── new_agent_hooks.py  # Framework-specific hooks
```

### Adding New Tool Types
```
tools/new_tool_type/
├── __init__.py
├── tools.py           # Tool implementations extending Tool ABC
└── client.py          # Protocol-specific client (if needed)
```

### Adding New Domain Agents
Domain agents are now created through the framework adapter system rather than pre-defined directories. They are managed by the AgentManager using factory patterns.

### Adding Infrastructure Services
```
infrastructure/new_service/
├── __init__.py
├── service.py         # Service implementation
└── adapters.py        # Framework-specific adapters (if needed)
```