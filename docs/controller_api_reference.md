# Aether Frame Controller API Reference

## Overview

The Aether Frame Controller API is a FastAPI-based HTTP service that provides standardized interfaces for interacting with AI assistant systems. The API adopts a clear responsibility separation design to support different use cases.

### Interface Responsibility Division

1. **`/api/v1/create-agent`** - Pre-create context, returns `agent_id` and `session_id`
2. **`/api/v1/chat`** - Continuous conversation based on existing context (requires `agent_id` and `session_id`)
3. **`/api/v1/process`** - One-time task processing (automatically creates temporary context)
4. **`/api/v1/health`** - Service health check

### Basic Information

- **Base URL**: `http://localhost:8000`
- **API Version**: `v1`
- **API Prefix**: `/api/v1`
- **Documentation**: `http://localhost:8000/docs` (Swagger UI)
- **Protocol**: HTTP/HTTPS
- **Data Format**: JSON

### Features

- üöÄ **High Performance**: Based on FastAPI and uvicorn, supports asynchronous processing
- üîß **Flexible Configuration**: Supports multiple AI models and parameter configurations
- üéØ **Multiple Modes**: Simple chat, advanced processing, context management
- üõ†Ô∏è **Tool Integration**: Supports built-in tools and custom tools
- üìä **Monitoring Support**: Provides health checks and detailed status information
- üîÑ **Session Management**: Supports session persistence and context reuse



## Authentication & Security

The current version does not implement authentication mechanisms, and all interfaces are publicly accessible. For production deployment, it is recommended to:

- Configure reverse proxy (such as Nginx)
- Add API key authentication
- Enable HTTPS
- Configure CORS policies
- Implement rate limiting

## Error Handling

The API uses standard HTTP status codes and returns different error response formats based on different error types:

### Business Logic Errors (500)

```json
{
  "error": "Chat processing failed",
  "message": "Specific error message",
  "processing_time": 1.234
}
```

### Service Unavailable Errors (503)

```json
{
  "detail": "Failed to initialize controller service: specific error message"
}
```

### Parameter Validation Errors (422)

```json
{
  "detail": [
    {
      "loc": ["body", "message"],
      "msg": "field required",
      "type": "value_error.missing"
    }
  ]
}
```

### Global Exception Errors (500)

```json
{
  "error": "Internal server error",
  "message": "An unexpected error occurred",
  "type": "internal_error"
}
```

### Common Status Codes

- `200` - Request successful
- `404` - Interface not found
- `422` - Data validation failed (automatically generated by FastAPI)
- `500` - Internal server error
- `503` - Service unavailable
## Interface Details

### 1. Health Check Interfaces

#### 1.1 Basic Health Check

**Endpoint**: `GET /api/v1/health`

**Description**: Check basic service health status

**Request Parameters**: None

**Response Format**:
```json
{
  "status": "healthy",
  "service": "ControllerService", 
  "timestamp": "2025-09-28T22:17:19.107386",
  "initialized": true,
  "error": "Error message (only appears when status is unhealthy)"
}
```

**Response Field Descriptions**:
- `status`: Service status (`healthy` | `unhealthy`)
- `service`: Service name, fixed as "ControllerService"
- `timestamp`: Check timestamp in ISO 8601 format
- `initialized`: Whether the service has been initialized
- `error`: Error message (optional, only appears when status is unhealthy)

**Example Request**:
```bash
curl -X GET "http://localhost:8000/api/v1/health"
```

**Example Response (Healthy Status)**:
```json
{
  "status": "healthy",
  "service": "ControllerService",
  "timestamp": "2025-09-28T22:17:19.107386",
  "initialized": true
}
```

**Example Response (Unhealthy Status)**:
```json
{
  "status": "unhealthy",
  "service": "ControllerService",
  "timestamp": "2025-09-28T22:17:19.107386",
  "initialized": true,
  "error": "'AgentManager' object has no attribute 'list_agents'"
}
```

#### 1.2 Detailed Health Check

**Endpoint**: `GET /api/v1/health/detailed`

**Description**: Get detailed system health information and component status

**Request Parameters**: None

**Response Format**:
```json
{
  "overall_status": "healthy",
  "service": "ControllerService",
  "timestamp": "2025-09-28T22:17:45.511120",
  "initialized": true,
  "error": "Error message (only appears when status is abnormal)",
  "components": {
    "framework_registry": {
      "status": "healthy",
      "available_frameworks": ["adk"]
    },
    "tool_service": {
      "service_status": "healthy",
      "total_tools": 3,
      "namespaces": ["builtin"],
      "tools": {
        "builtin.echo": {
          "tool": "builtin.echo",
          "status": "not_initialized"
        },
        "builtin.timestamp": {
          "tool": "builtin.timestamp", 
          "status": "not_initialized"
        },
        "builtin.chat_log": {
          "status": "not_initialized",
          "log_directories": {
            "base": "logs",
            "sessions": "logs/sessions",
            "chats": "logs/chats"
          },
          "directories_exist": {
            "base": true,
            "sessions": true,
            "chats": true
          }
        }
      }
    }
  },
  "endpoints": {
    "health": "/api/v1/health",
    "chat": "/api/v1/chat", 
    "process": "/api/v1/process"
  },
  "version": "1.0.0",
  "api_docs": "/docs"
}
```

**Response Field Descriptions**:
- `overall_status`: Overall service status
- `service`: Service name
- `timestamp`: Check timestamp
- `initialized`: Service initialization status
- `error`: Error message (optional)
- `components`: Detailed status of each component
  - `framework_registry`: Framework registry status
  - `tool_service`: Tool service status, including tool details
- `endpoints`: Available API endpoints
- `version`: API version
- `api_docs`: API documentation address

**Example Request**:
```bash
curl -X GET "http://localhost:8000/api/v1/health/detailed"
```

**Example Response**:
```json
{
  "overall_status": "unhealthy",
  "components": {
    "framework_registry": {
      "status": "healthy",
      "available_frameworks": ["adk"]
    },
    "tool_service": {
      "service_status": "healthy",
      "total_tools": 3,
      "namespaces": ["builtin"],
      "tools": {
        "builtin.echo": {"tool": "builtin.echo", "status": "not_initialized"},
        "builtin.timestamp": {"tool": "builtin.timestamp", "status": "not_initialized"},
        "builtin.chat_log": {
          "status": "not_initialized",
          "log_directories": {"base": "logs", "sessions": "logs/sessions", "chats": "logs/chats"},
          "directories_exist": {"base": true, "sessions": true, "chats": true}
        }
      }
    }
  },
  "error": "'AgentManager' object has no attribute 'list_agents'",
  "service": "ControllerService",
  "initialized": true,
  "timestamp": "2025-09-28T22:17:45.511120",
  "endpoints": {"health": "/api/v1/health", "chat": "/api/v1/chat", "process": "/api/v1/process"},
  "version": "1.0.0",
  "api_docs": "/docs"
}
```

### 2. Chat Interfaces

#### 2.1 Continuous Conversation

**Endpoint**: `POST /api/v1/chat`

**Description**: Conduct continuous conversation based on pre-created context, requires creating context through `/api/v1/create-agent` first

**Prerequisites**: Must call `/api/v1/create-agent` first to obtain `agent_id` and `session_id`

**Request Format**:
```json
{
  "message": "User message content",
  "agent_id": "agent_abc123def456",
  "session_id": "adk_session_789xyz012",
  "metadata": {}
}
```

**Request Field Descriptions**:
- `message` (required): User message content
- `agent_id` (required): Agent ID obtained from create-agent interface
- `session_id` (required): Session ID obtained from create-agent interface
- `metadata` (optional): Additional metadata

**Response Format**:
```json
{
  "task_id": "chat_1759070144797",
  "status": "success",
  "message": "AI assistant's reply content",
  "processing_time": 3.074,
  "agent_id": "agent_abc123def456",
  "session_id": "adk_session_789xyz012",
  "metadata": {
    "framework": "adk",
    "agent_id": "agent_abc123def456",
    "session_id": "adk_session_789xyz012",
    "execution_id": "exec_chat_1759070144797",
    "pattern": "continue_existing_session",
    "processed_by": "ControllerService",
    "processing_time": 3.073987,
    "timestamp": "2025-09-28T22:35:47.871358"
  }
}
```

**Response Field Descriptions**:
- `task_id`: Unique task identifier
- `status`: Processing status (`success` | `error`)
- `message`: AI assistant's reply content
- `processing_time`: Processing time (seconds)
- `agent_id`: Agent ID used
- `session_id`: Session ID used
- `metadata`: Response metadata

**Complete Usage Flow**:

1. **Step 1: Create Context**
```bash
curl -X POST "http://localhost:8000/api/v1/create-agent" \
  -H "Content-Type: application/json" \
  -d '{
    "agent_type": "chat_assistant",
    "system_prompt": "You are a friendly chat assistant"
  }'
```

2. **Step 2: Use Returned IDs for Chat**
```bash
curl -X POST "http://localhost:8000/api/v1/chat" \
  -H "Content-Type: application/json" \
  -d '{
    "message": "Hello, please introduce yourself",
    "agent_id": "agent_4eac6fdbe04d",
    "session_id": "adk_session_f5674dbcd852"
  }'
```

**Example Response**:
```json
{
  "task_id": "chat_1759070144797",
  "status": "success",
  "message": "Hello! I am a chat assistant, happy to serve you. I can help you save chat conversation records to local files. What can I do for you?",
  "processing_time": 3.074,
  "agent_id": "agent_4eac6fdbe04d",
  "session_id": "adk_session_f5674dbcd852",
  "metadata": {
    "framework": "adk",
    "pattern": "continue_existing_session"
  }
}
```

**Error Response (Missing Required Fields)**:
```json
{
  "detail": [
    {
      "type": "missing",
      "loc": ["body", "agent_id"],
      "msg": "Field required",
      "input": {"message": "Hello"}
    },
    {
      "type": "missing", 
      "loc": ["body", "session_id"],
      "msg": "Field required",
      "input": {"message": "Hello"}
    }
  ]
}
```
### 3. Advanced Processing Interfaces

#### 3.1 One-time Task Processing

**Endpoint**: `POST /api/v1/process`

**Description**: One-time task processing interface that creates new agents and sessions for each request, suitable for independent task processing

**Features**: 
- Creates temporary agents and sessions for each call
- Does not maintain session state, suitable for independent tasks
- Supports tool calls and custom configurations

**Request Format**:
```json
{
  "task_type": "Task type",
  "description": "Task description",
  "messages": [
    {
      "role": "user",
      "content": "Message content",
      "metadata": {}
    }
  ],
  "model": "deepseek-chat",
  "temperature": 0.7,
  "max_tokens": 1500,
  "agent_type": "conversational_assistant",
  "system_prompt": "System prompt",
  "available_tools": ["tool1", "tool2"],
  "metadata": {}
}
```

**Request Field Descriptions**:
- `task_type` (required): Task type identifier
- `description` (optional): Task description
- `messages` (required): Message list
  - `role`: Message role (`user` | `assistant` | `system`)
  - `content`: Message content
  - `metadata`: Message metadata
- `model` (optional): AI model name, default `deepseek-chat`
- `temperature` (optional): Model temperature parameter, default 0.7
- `max_tokens` (optional): Maximum generated tokens, default 1500
- `agent_type` (optional): Agent type, default `conversational_assistant`
- `system_prompt` (optional): System prompt
- `available_tools` (optional): Available tools list
- `metadata` (optional): Task metadata

**Response Format**:
```json
{
  "task_id": "process_1759070154759",
  "status": "success",
  "messages": [
    {
      "role": "assistant",
      "content": "AI assistant's reply content",
      "metadata": {
        "framework": "adk",
        "agent_id": "domain_agent_process_1759070154759"
      }
    }
  ],
  "processing_time": 6.424,
  "error_message": null,
  "metadata": {
    "framework": "adk",
    "agent_id": "agent_d039ed407661",
    "session_id": "adk_session_cafe5dfbb327",
    "execution_id": "exec_process_1759070154759",
    "pattern": "create_new_agent_and_session",
    "processed_by": "ControllerService",
    "processing_time": 6.424562,
    "timestamp": "2025-09-28T22:36:01.183800"
  }
}
```

**Response Field Descriptions**:
- `task_id`: Unique task identifier
- `status`: Processing status (`success` | `error`)
- `messages`: Response message list
- `processing_time`: Processing time (seconds)
- `error_message`: Error message (if any)
- `metadata`: Response metadata, including automatically created agent_id and session_id

**Example Request**:
```bash
curl -X POST "http://localhost:8000/api/v1/process" \
  -H "Content-Type: application/json" \
  -d '{
    "task_type": "analysis",
    "description": "Data analysis task",
    "messages": [
      {
        "role": "user",
        "content": "Give me a simple pie chart",
        "metadata": {"source": "test"}
      }
    ],
    "model": "deepseek-chat",
    "temperature": 0.5,
    "max_tokens": 2000,
    "agent_type": "analytical_assistant",
    "system_prompt": "You are a helpful AI assistant",
    "available_tools": ["calculator"],
    "metadata": {"priority": "normal"}
  }'
```

**Example Response**:
```json
{
  "task_id": "process_1759070154759",
  "status": "success",
  "messages": [
    {
      "role": "assistant",
      "content": "I currently cannot generate a pie chart for you as the related chart generation functionality is temporarily unavailable. However, I can provide you with some alternatives: 1. Describe pie chart structure 2. Provide data suggestions 3. Recommend tools",
      "metadata": {
        "framework": "adk",
        "agent_id": "domain_agent_process_1759070154759"
      }
    }
  ],
  "processing_time": 6.424,
  "error_message": null,
  "metadata": {
    "framework": "adk",
    "agent_id": "agent_d039ed407661",
    "session_id": "adk_session_cafe5dfbb327",
    "pattern": "create_new_agent_and_session"
  }
}
```
### 4. Context Management Interfaces

#### 4.1 Create Runtime Context

**Endpoint**: `POST /api/v1/create-agent`

**Description**: Pre-create runtime context (RuntimeContext), including agents, runners, and sessions, to improve response speed for subsequent requests

**Request Format**:
```json
{
  "agent_type": "Agent type",
  "system_prompt": "System prompt",
  "model": "deepseek-chat",
  "temperature": 0.7,
  "max_tokens": 1500,
  "available_tools": ["tool1", "tool2"],
  "user_id": "User ID",
  "framework_config": {},
  "metadata": {}
}
```

**Request Field Descriptions**:
- `agent_type` (required): Agent type
- `system_prompt` (required): System prompt
- `model` (optional): AI model name, default `deepseek-chat`
- `temperature` (optional): Model temperature parameter, default 0.7
- `max_tokens` (optional): Maximum generated tokens, default 1500
- `available_tools` (optional): Available tools list
- `user_id` (optional): User ID
- `framework_config` (optional): Framework-specific configuration
- `metadata` (optional): Additional metadata

**Response Format**:
```json
{
  "agent_id": "agent_abc123def456",
  "session_id": "adk_session_789xyz012", 
  "runner_id": "runner_456ghi789",
  "framework_type": "ADK",
  "agent_type": "analytical_assistant",
  "model": "deepseek-chat",
  "created_at": "2025-01-28T10:30:45.123456",
  "processing_time": 0.856,
  "metadata": {
    "user_id": "user_123",
    "execution_id": "exec_context_create_1738056645123",
    "pattern": "create_new_agent_and_session",
    "created_by": "ControllerService"
  }
}
```

**Response Field Descriptions**:
- `agent_id`: Created agent ID
- `session_id`: Created session ID
- `runner_id`: Created runner ID
- `framework_type`: Framework type used
- `agent_type`: Agent type
- `model`: Model used
- `created_at`: Creation timestamp
- `processing_time`: Creation time (seconds)
- `metadata`: Context metadata

**Example Request**:
```bash
curl -X POST "http://localhost:8000/api/v1/create-agent" \
  -H "Content-Type: application/json" \
  -d '{
    "agent_type": "echarts_generator",
    "system_prompt": "You are a professional ECharts chart generator, only output ECharts configuration code",
    "model": "deepseek-chat",
    "temperature": 0.3,
    "max_tokens": 2000,
    "available_tools": [],
    "user_id": "user_123",
    "framework_config": {
      "provider": "deepseek"
    },
    "metadata": {
      "purpose": "chart_generation",
      "priority": "high"
    }
  }'
```

**Example Response**:
```json
{
  "agent_id": "agent_abc123def456",
  "session_id": "adk_session_789xyz012",
  "runner_id": "runner_456ghi789", 
  "framework_type": "ADK",
  "agent_type": "echarts_generator",
  "model": "deepseek-chat",
  "created_at": "2025-01-28T10:30:45.123456",
  "processing_time": 0.856,
  "metadata": {
    "user_id": "user_123",
    "execution_id": "exec_context_create_1738056645123",
    "pattern": "create_new_agent_and_session",
    "created_by": "ControllerService",
    "purpose": "chart_generation",
    "priority": "high"
  }
}
```

#### 4.2 Using Pre-created Context

After creating context, you must use the `/api/v1/chat` interface to use the returned `agent_id` and `session_id`:

```bash
curl -X POST "http://localhost:8000/api/v1/chat" \
  -H "Content-Type: application/json" \
  -d '{
    "message": "Generate a pie chart showing sales data",
    "agent_id": "agent_abc123def456",
    "session_id": "adk_session_789xyz012"
  }'
```

**Note**: The `/api/v1/process` interface does not support using pre-created contexts; it always creates new temporary contexts.## Data Models

### Message Model (ChatMessage)

```json
{
  "role": "user | assistant | system",
  "content": "Message content",
  "metadata": {
    "source": "Source identifier",
    "timestamp": "Timestamp",
    "custom_field": "Custom field"
  }
}
```

### Agent Configuration Model (AgentConfig)

```json
{
  "agent_type": "Agent type",
  "system_prompt": "System prompt",
  "model_config": {
    "model": "Model name",
    "temperature": 0.7,
    "max_tokens": 1500
  },
  "available_tools": ["Tool list"],
  "framework_config": {
    "provider": "Provider",
    "custom_settings": "Custom settings"
  }
}
```

### Task Result Model (TaskResult)

```json
{
  "task_id": "Task ID",
  "status": "success | error",
  "messages": ["Message list"],
  "processing_time": 1.234,
  "error_message": "Error message (if any)",
  "metadata": {
    "framework": "Framework type",
    "agent_id": "Agent ID",
    "session_id": "Session ID"
  }
}
```

## Use Cases

### Scenario 1: One-time Task Processing

Suitable for independent task processing without maintaining session state:

```bash
curl -X POST "http://localhost:8000/api/v1/process" \
  -H "Content-Type: application/json" \
  -d '{
    "task_type": "question_answer",
    "messages": [{"role": "user", "content": "What is artificial intelligence?"}],
    "agent_type": "conversational_assistant",
    "system_prompt": "You are a knowledgeable AI assistant"
  }'
```

### Scenario 2: Professional Domain Assistant

Create specialized chart generation assistant and conduct continuous conversation:

```bash
# 1. Create professional context
curl -X POST "http://localhost:8000/api/v1/create-agent" \
  -H "Content-Type: application/json" \
  -d '{
    "agent_type": "echarts_generator",
    "system_prompt": "You are a professional ECharts chart generator, only output configuration wrapped in ```echarts code blocks",
    "temperature": 0.3
  }'

# 2. Use chat interface for continuous conversation
curl -X POST "http://localhost:8000/api/v1/chat" \
  -H "Content-Type: application/json" \
  -d '{
    "message": "Generate a pie chart showing company department personnel distribution: Tech 40 people, Sales 30 people, Marketing 20 people, Admin 10 people",
    "agent_id": "agent_8f6c3070975f",
    "session_id": "adk_session_d2940c3846c0"
  }'
```

### Scenario 3: Multi-turn Conversation

Maintain continuous interaction with conversation context:

```bash
# 1. Create programming tutor context
curl -X POST "http://localhost:8000/api/v1/create-agent" \
  -H "Content-Type: application/json" \
  -d '{
    "agent_type": "programming_tutor",
    "system_prompt": "You are a Python programming tutor, skilled at progressive teaching"
  }'

# 2. First round of conversation
curl -X POST "http://localhost:8000/api/v1/chat" \
  -H "Content-Type: application/json" \
  -d '{
    "message": "I want to learn Python",
    "agent_id": "agent_abc123",
    "session_id": "session_xyz789"
  }'

# 3. Second round of conversation (maintaining context)
curl -X POST "http://localhost:8000/api/v1/chat" \
  -H "Content-Type: application/json" \
  -d '{
    "message": "Where should I start learning?",
    "agent_id": "agent_abc123",
    "session_id": "session_xyz789"
  }'
```

### Scenario 4: Tool Invocation

Use built-in tools for calculation or data processing:

```bash
curl -X POST "http://localhost:8000/api/v1/process" \
  -H "Content-Type: application/json" \
  -d '{
    "task_type": "calculation",
    "messages": [{"role": "user", "content": "Calculate the result of (25 + 75) * 2"}],
    "agent_type": "calculator_assistant",
    "available_tools": ["calculator", "chat_log"],
    "system_prompt": "You are a calculation assistant that can use calculator tools"
  }'
```

### Scenario 5: Batch Processing

Pre-create dedicated contexts for multiple users:

```bash
# Create dedicated assistant for user1
curl -X POST "http://localhost:8000/api/v1/create-agent" \
  -H "Content-Type: application/json" \
  -d '{
    "agent_type": "personal_assistant",
    "system_prompt": "You are user1's personal assistant",
    "user_id": "user1"
  }'

# Create dedicated assistant for user2
curl -X POST "http://localhost:8000/api/v1/create-agent" \
  -H "Content-Type: application/json" \
  -d '{
    "agent_type": "personal_assistant", 
    "system_prompt": "You are user2's personal assistant",
    "user_id": "user2"
  }'

# Use user1's context for chat
curl -X POST "http://localhost:8000/api/v1/chat" \
  -H "Content-Type: application/json" \
  -d '{
    "message": "Help me arrange today's schedule",
    "agent_id": "user1_agent_id",
    "session_id": "user1_session_id"
  }'
```

## Performance Optimization

### Context Pre-creation Advantages

Using `/api/v1/create-agent` to pre-create contexts can significantly improve performance:

- **Initialization Time**: 0.8-1.2 seconds (including agent creation, model loading, etc.)
- **Subsequent Request Time**: 0.2-0.5 seconds (directly using pre-created context)
- **Performance Improvement**: Approximately 60-80% reduction in response time

### Best Practices

#### 1. Context Management

```bash
# ‚úÖ Recommended: Pre-create common contexts at application startup

# Create chat assistant context
curl -X POST "http://localhost:8000/api/v1/create-agent" \
  -H "Content-Type: application/json" \
  -d '{"agent_type": "conversational_assistant", "system_prompt": "You are a chat assistant"}'

# Create data analysis assistant context  
curl -X POST "http://localhost:8000/api/v1/create-agent" \
  -H "Content-Type: application/json" \
  -d '{"agent_type": "data_analyst", "system_prompt": "You are a data analyst"}'

# Create programming assistant context
curl -X POST "http://localhost:8000/api/v1/create-agent" \
  -H "Content-Type: application/json" \
  -d '{"agent_type": "programming_assistant", "system_prompt": "You are a programming assistant"}'

# ‚úÖ Recommended: Reuse contexts for similar tasks
curl -X POST "http://localhost:8000/api/v1/process" \
  -H "Content-Type: application/json" \
  -d '{
    "task_type": "analysis",
    "messages": [{"role": "user", "content": "Analyze sales data"}],
    "agent_id": "analysis_agent_id",
    "session_id": "analysis_session_id"
  }'
```

#### 2. Session Strategy

```bash
# ‚úÖ Recommended: Use same session_id for long conversations to maintain context
# First conversation
curl -X POST "http://localhost:8000/api/v1/process" \
  -H "Content-Type: application/json" \
  -d '{
    "task_type": "conversation",
    "messages": [{"role": "user", "content": "I want to learn machine learning"}],
    "agent_id": "assistant_agent_id",
    "session_id": "user_conversation_session"
  }'

# Subsequent conversations use same session_id
curl -X POST "http://localhost:8000/api/v1/process" \
  -H "Content-Type: application/json" \
  -d '{
    "task_type": "conversation", 
    "messages": [{"role": "user", "content": "Where should I start?"}],
    "agent_id": "assistant_agent_id",
    "session_id": "user_conversation_session"
  }'

# ‚úÖ Recommended: Use different session_id for different tasks
curl -X POST "http://localhost:8000/api/v1/process" \
  -H "Content-Type: application/json" \
  -d '{
    "task_type": "new_task",
    "messages": [{"role": "user", "content": "Help me write a Python script"}],
    "agent_id": "assistant_agent_id"
  }'
```

#### 3. Error Handling

```bash
# ‚úÖ Recommended: Use curl's retry and timeout options
curl -X POST "http://localhost:8000/api/v1/process" \
  -H "Content-Type: application/json" \
  --retry 3 \
  --retry-delay 2 \
  --max-time 60 \
  --connect-timeout 10 \
  -d '{
    "task_type": "analysis",
    "messages": [{"role": "user", "content": "Analyze data"}]
  }'

# ‚úÖ Recommended: Check response status code
curl -X POST "http://localhost:8000/api/v1/process" \
  -H "Content-Type: application/json" \
  -w "HTTP Status: %{http_code}\n" \
  -d '{
    "task_type": "chat",
    "messages": [{"role": "user", "content": "Hello"}]
  }'
```

#### 4. Parameter Tuning

```json
{
  "temperature": 0.3,     // Use low temperature for professional tasks
  "max_tokens": 2000,     // Adjust token count based on needs
  "model": "deepseek-chat" // Choose appropriate model
}
```

## API Call Considerations

### Common Error Responses

#### 1. Parameter Validation Failed (422)

```json
{
  "detail": [
    {
      "loc": ["body", "message"],
      "msg": "field required",
      "type": "value_error.missing"
    }
  ]
}
```

**Cause**: Missing required parameters or incorrect parameter format

#### 2. Context Not Found (400)

```json
{
  "error": "Process request failed",
  "message": "Agent agent_invalid_id not found",
  "type": "execution_error"
}
```

**Cause**: Used invalid `agent_id` or `session_id`

#### 3. Service Unavailable (503)

```json
{
  "error": "Service unavailable", 
  "message": "Failed to initialize controller service",
  "type": "service_error"
}
```

**Cause**: Service not properly initialized or insufficient system resources

#### 4. Request Timeout (500)

```json
{
  "error": "Internal server error",
  "message": "Task execution timeout",
  "processing_time": 30.0
}
```

**Cause**: Task processing time exceeded limit

### API Call Recommendations

#### 1. Timeout Settings

Recommended timeout settings for different interfaces:
- `/health`: 5 seconds
- `/chat`: 30 seconds  
- `/process`: 60 seconds
- `/create-agent`: 30 seconds

#### 2. Retry Strategy

For temporary errors (5xx status codes), implement exponential backoff retry:

```bash
# Use curl's built-in retry functionality
curl -X POST "http://localhost:8000/api/v1/process" \
  -H "Content-Type: application/json" \
  --retry 3 \
  --retry-delay 1 \
  --retry-max-time 30 \
  -d '{
    "task_type": "analysis",
    "messages": [{"role": "user", "content": "Analyze data"}]
  }'

# Or use script to implement exponential backoff
for i in {1..3}; do
  if curl -X POST "http://localhost:8000/api/v1/process" \
    -H "Content-Type: application/json" \
    --max-time 30 \
    -d '{"task_type": "test", "messages": [{"role": "user", "content": "test"}]}'; then
    break
  else
    sleep $((2**i))
  fi
done
```

#### 3. Status Check

Before calling business interfaces, check service status first:
```bash
curl -f http://localhost:8000/api/v1/health
```

## Version Information

- **Current Version**: 1.0.0
- **API Version**: v1
- **Last Updated**: 2025-01-28
- **Compatibility**: Python 3.8+

## Support & Feedback

If you have questions or suggestions, please:

1. Check detailed logs for initial diagnosis
2. Use test scripts to verify interface functionality
3. Check system resources and network connectivity
4. Refer to the troubleshooting section in this document

---

*This document is based on Aether Frame Controller API v1.0.0 and covers all major interfaces and use cases.*